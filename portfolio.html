<!DOCTYPE html>
<html>
    <head>
        <title>Portfolio</title>
        <link rel='stylesheet' href='style.css'>
        
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <script type="text/javascript" src="js/processing.js"></script>
    </head>
    <body>
        <header>
            <h1>Portfolio</h1>
            <ul>
                <li><a class="interactive" href="index.html">Home</a></li>
                <li><a class="interactive" href="portfolio.html">Portfolio</a></li>
                <li><a class="interactive" href="blog.html">Blog</a></li>
            </ul>         
            <br>
        </header>
        
        <hr>
        <script type="text/processing">
            PImage bg, flake, topPipe, botPipe;
            int bgx, bgy, fx, fy, g, Vfy;
            int[] pipeX, pipeY; //Declare two arrays   
            int gameState, score;
            
            //One time
            void setup(){
              size(800,486);
              //noCursor();
              bg = loadImage("./img/bg.PNG");
              flake = loadImage("./img/flake.png");
              topPipe = loadImage("./img/topPipe.png");
              botPipe = loadImage("./img/bottomPipe.png");
              fx = 100;
              fy = 50;
              g = 1; //Gravity = Speed of downward acceleration
              pipeX = new int[5]; //[0,0,0,0]
              pipeY = new int[pipeX.length];
              //Populate the Array with values
              for(int i = 0; i < pipeX.length; i++){
                pipeX[i] = width/2 + 200*i;
                pipeY[i] = (int)random(-350, 0);
              }
              gameState = -1;
            }
            
            //Main Game Loop
            void draw(){
                if(gameState == -1){
                  startScreen();
                }else if(gameState == 0){
                  setBg();
                  setPipes();
                  flake(); //Puts Flake on top
                  score();
                }else{
                  fill(255);
                  text("You Lose", 20, 100);
                }
            }
            
            void score(){
              fill(0);
              textSize(32);
              text("Score: " + score, width -170, 40);
            }
            
            void startScreen(){
              image(bg, 0, 0);
              textSize(40);
              fill(255,50,30);
              text("Welcome to Flappy Bird", 40, 100);
              text("Click the mouse or any key to begin", 40, 200);
              if(mousePressed){
                fy = height/2;
                gameState = 0;
              }
              if(keyPressed){
                fy = height/2;
                gameState = 0;
              }
            }
            
            void setPipes(){
                  for(int i = 0; i<pipeX.length; i++){
                  image(topPipe, pipeX[i], pipeY[i]);
                  image(botPipe, pipeX[i], pipeY[i] + 530);
                  pipeX[i]-=4;
                  if(pipeX[i] < -200){
                    pipeX[i] = width;
                  }
                  if(fx > (pipeX[i] - 27) && fx < pipeX[i] + 90){
                    if(!(fy > (pipeY[i] + 350 ) && fy < pipeY[i] + (350 + 180 - 45))){
                      gameState = 1;
                    }else if(fx == pipeX[i]){
                      score++;
                    }
                  }
                }
            }
            
            void flake(){
                image(flake,fx,fy);
                fy = fy + Vfy;
                Vfy = Vfy + g;
                if(fy > height || fy < 0){
                  fill(255);
                  textSize(42);
                  text("Oh no Corn Flake fell off the screen", 70, 250);
                  gameState = 1;
                }
            }
            
            void mousePressed(){
              Vfy = -12;
            }
            
            void keyPressed(){
              Vfy = -12;
            }
            
            void setBg(){
              image(bg, bgx, bgy);
              image(bg, bgx + bg.width, bgy);
              bgx = bgx - 4;
              
              if(bgx < -bg.width){
                bgx = 0; // Resets it once first image is done
              }
            }
            
        </script>
        <canvas id="sketch" style="border: 1px solid black;"></canvas>
        <iframe src="https://editor.p5js.org/TundraGrassland/embed/fPvwyUH_s" height = "400px" width = "400px"></iframe>
    </body>
</html>
